\subsection{Proof that a committed value is a multiplication of other values (and in particular, a square)}

This is the protocol used for proving that a discrete logarithm representation is a product of two discrete logarithm representations in an honest verifier zero knowledge way \cite{FOcomm2}. In particular, this protocol can be used to prove that a committed number is a square, as in \cite{boudotInterval}.

Suppose the Prover knows secrets $x,y,z$ such that $x = y*z$ and wants to prove this to an honest verifier. The Verifier knows commitments to each of these numbers: $C_x$ is a commitment to $x$, $C_y$ is to $y$ and $C_z$ is to $z$. We call this protocol \textbf{Mult}. It uses Fujisaki-Okamoto commitments. Therefore it requires the same setup and the same assumptions. Everything said for the Fujisaki-Okamoto commitments also applies here.



\textsc{Assumptions}:\\
The security of the scheme relies on Strong RSA assumption.


\textsc{Honest-Verifier Zero Knowledge}:\\
The protocol is honest verifier zero knowledge provided that the Fujisaki-Okamoto commitment is hiding. This means that the RSA group must be generated by a trusted third party or it must be proven to the Prover that each $g_i,h$ generates $QR_n$.


\textsc{Soundness}:\\
The extraction works under the Strong RSA assumption, which requires that the RSA group may NOT be generated by the Prover.




\begin{algorithm}[H]\label{randProofUnknownMultiply}
\SetKwComment{Comment}{}{}
\dontprintsemicolon

\KwIn{Definition of the RSA group and bases: $n,g_1,h$}
\KwOut{randomized proof $R$, its opening $openR$}
\BlankLine

\Comment{Randomize Proof} \;
\Indp
  Pick a random number $s$ from $D_R$. \;
  Create a random element $R_1$ using Randomize(group definition, $1$, $1$,  $g_1,h$, $s$) as in Algorithm \ref{randomize} where $s$ is a fixed element. Let the random exponent returned by the Randomize procedure be $openR_1 = t_1$. \;
  Create a random element $R_2$ using Randomize(group definition, $1$, $1$,  $C_y,h$, $s$) as in Algorithm \ref{randomize} where $s$ is again a fixed element. Note the use of $C_y$ as one of the bases in the procedure (it will be used with the fixed element). Let the random exponent returned by the Randomize procedure be $openR_2 = t_2$. \;
  Output randomized proof $R = R_1,R_2$ and opening $openR = s,t_1,t_2$. \;
\Indm

\caption{Randomized Proof round of a Mult protocol for $x = yz$. This procedure is run by the Prover.}
\end{algorithm}




\begin{algorithm}[H]\label{respondUnknownMultiply}
\SetKwComment{Comment}{}{}
\dontprintsemicolon

\KwIn{Definition of the RSA group and bases: $n,g_1,h$, openings to commitments $C_x,C_y,C_z$ as $openX = x,r_x$, $openY = y,r_y$, $openZ = z,r_z$, randomized proof $R = R_1,R_2$ and its opening $openR = s,t_1,t_2$, challenge $c$}
\KwOut{response $A$}
\BlankLine

\Comment{Respond} \;
\Indp
  Compute $a = s + c z$, $b_1 = t_1 + c r_z$, $b_2 = t_2 + c(r_x - z r_y)$ \;
  Output response $A = a,b_1,b_2$ \;
\Indm

\caption{Response round of a Mult protocol for $x = yz$. This procedure is run by the Prover.}
\end{algorithm}






\begin{algorithm}[H]\label{verifyUnknownMultiply}
\SetKwComment{Comment}{}{}
\dontprintsemicolon

\KwIn{Definition of the RSA group and bases: $n,g_1,h$, commitments $C_x,C_y,C_z$, randomized proof $R = R_1,R_2$, challenge $c$, response $A = a,b_1,b_2$}
\KwOut{$\accept$ or $\reject$}
\BlankLine

\Comment{Verify} \;
\Indp
  \If{$R_1 C_{z}^{c} = g_{1}^{a} h^{b_1} \mod n$ $\mathrm{AND}$ $R_2 C_{x}^{c} = C_{y}^{a} h^{b_2} \mod n$}
    {Output $\accept$ \;}
  \Else
    {Output $\reject$ \;}
\Indm

\caption{Verification of a Mult protocol for $x = yz$. This procedure is run by the Verifier upon receipt of response $A$ from the Prover.}
\end{algorithm}




\textsc{Proving knowledge of $x,y$ such that $ x = y^2 $}:\\
Using the proof above, it is very easy to prove knowledge of $x,y$ such that $ x = y^2 $. Just set $ z = y $, which also means getting rid of $ C_z $, or in other words, setting $ C_z = C_yÂ $ and hence $ openC_z = openC_y $.
